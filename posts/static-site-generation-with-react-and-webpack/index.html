<!DOCTYPE html><html><head><meta charset="utf-8"><title>Static Site Generation with React and Webpack | jxnblk.com/writing</title><meta name="description" content="Thoughts on Design, Minimalism, and the Web"><meta name="author" content="Brent Jackson"><meta name="keywords" content="blog,writing,design,minimalism,react,webpack,static-site,tutorial"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body,h1,h2,h3,h4,h5,h6{font-family:Helvetica Neue,Helvetica,sans-serif}dl,ol,p,pre,ul{margin-top:0;margin-bottom:1.5rem}a,a:hover{text-decoration:underline}.nowrap,.truncate{white-space:nowrap}.fit,.truncate,img{max-width:100%}body{margin:0;line-height:1.625;font-size:100%;color:#111;background-color:#fff}svg{max-height:100%}h1,h2,h3,h4,h5,h6{font-weight:500;line-height:1.25;margin-top:1em;margin-bottom:.5em}dl,ol,p,ul{font-size:1.125rem}code,pre,samp{font-family:Source Code Pro,Consolas,monospace;font-size:inherit}pre{overflow-x:scroll}.overflow-hidden,.truncate{overflow:hidden}blockquote{margin:3rem 0;padding:0 1.5rem}blockquote,blockquote p{font-size:1.25rem;font-style:italic}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1.125rem}.h5,h5{font-size:.875rem}.h6,h6{font-size:.75rem}.list-reset{list-style:none;padding-left:0}a{color:inherit}code,pre{background-color:transparent;border-radius:3px}hr{margin-top:3rem;margin-bottom:3rem;border:0;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgba(0,0,0,.125)}.button,pre{border-radius:3px}.button{color:#fff;background-color:#0074d9}.button:hover{box-shadow:inset 0 0 0 20rem rgba(0,0,0,.0625)}.button:focus{outline:0;border-color:rgba(0,0,0,.125);box-shadow:0 0 0 3px rgba(0,0,0,.25)}.button.is-active,.button:active{box-shadow:inset 0 0 0 20rem rgba(0,0,0,.125),inset 0 3px 4px 0 rgba(0,0,0,.25),0 0 1px rgba(0,0,0,.125)}.button.is-disabled,.button:disabled{opacity:.5}.bold{font-weight:700;font-weight:500}.regular{font-weight:400}.italic{font-style:italic}.caps{text-transform:uppercase;letter-spacing:.2em}.left-align{text-align:left}.center{text-align:center}.right-align{text-align:right}.justify{text-align:justify}.break-word{word-wrap:break-word}.truncate{text-overflow:ellipsis}.inline{display:inline}.block{display:block}.inline-block{display:inline-block}.table{display:table}.table-cell{display:table-cell}.overflow-scroll{overflow:scroll}.overflow-auto{overflow:auto}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.left{float:left}.right{float:right}.half-width{width:50%}.full-width{width:100%}.m0{margin:0}.mt0{margin-top:0}.mr0{margin-right:0}.mb0{margin-bottom:0}.ml0{margin-left:0}.m1{margin:.75rem}.mt1{margin-top:.75rem}.mr1{margin-right:.75rem}.mb1{margin-bottom:.75rem}.ml1{margin-left:.75rem}.m2{margin:1.5rem}.mt2{margin-top:1.5rem}.mr2{margin-right:1.5rem}.mb2{margin-bottom:1.5rem}.ml2{margin-left:1.5rem}.m3{margin:3rem}.mt3{margin-top:3rem}.mr3{margin-right:3rem}.mb3{margin-bottom:3rem}.ml3{margin-left:3rem}.m4{margin:6rem}.mt4{margin-top:6rem}.mr4{margin-right:6rem}.mb4{margin-bottom:6rem}.ml4{margin-left:6rem}.mxn1{margin-left:-.75rem;margin-right:-.75rem}.mxn2{margin-left:-1.5rem;margin-right:-1.5rem}.mxn3{margin-left:-3rem;margin-right:-3rem}.mxn4{margin-left:-6rem;margin-right:-6rem}.container,.mx-auto{margin-right:auto;margin-left:auto}.p1{padding:.75rem}.py1{padding-top:.75rem;padding-bottom:.75rem}.px1{padding-left:.75rem;padding-right:.75rem}.p2{padding:1.5rem}.py2{padding-top:1.5rem;padding-bottom:1.5rem}.px2{padding-left:1.5rem;padding-right:1.5rem}.p3{padding:3rem}.py3{padding-top:3rem;padding-bottom:3rem}.px3{padding-left:3rem;padding-right:3rem}.p4{padding:6rem}.py4{padding-top:6rem;padding-bottom:6rem}.px4{padding-left:6rem;padding-right:6rem}.hljs{-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-javadoc{color:#aaa;font-style:italic}.css .rule .hljs-keyword,.hljs-keyword,.hljs-request,.hljs-status,.hljs-subst,.hljs-winutils,.nginx .hljs-title{color:#111;font-weight:700}.hljs-hexcolor,.hljs-number,.ruby .hljs-constant{color:#3d9970}.hljs-dartdoc,.hljs-phpdoc,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#ff4136}.hljs-id,.hljs-title,.scss .hljs-preprocessor{color:#ff4136;font-weight:700}.hljs-list .hljs-keyword,.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type,.tex .hljs-command,.vhdl .hljs-literal{color:#001f3f;font-weight:700}.django .hljs-tag .hljs-keyword,.hljs-rules .hljs-property,.hljs-tag,.hljs-tag .hljs-title{color:#001f3f;font-weight:400}.hljs-attribute,.hljs-regexp,.hljs-variable,.lisp .hljs-body{color:#3d9970}.clojure .hljs-keyword,.hljs-prompt,.hljs-symbol,.lisp .hljs-keyword,.ruby .hljs-symbol .hljs-string,.scheme .hljs-keyword,.tex .hljs-special{color:#b10dc9}.hljs-built_in{color:#001f3f}.hljs-cdata,.hljs-doctype,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-shebang{color:#aaa;font-weight:700}.hljs-deletion{background:#f012be}.hljs-addition{background:#01ff70}.diff .hljs-change{background:#001f3f}.hljs-chunk{color:#ddd}pre{padding:1.5rem;background-color:rgba(0,0,0,.0625)}code{color:#001f3f;background-color:rgba(127,219,255,.125)}.container{max-width:48rem}.link-simple{text-decoration:none}.prose,.serif{font-family:Georgia,serif;font-size:1.125rem}.prose dl,.prose ol,.prose p,.prose ul{font-size:inherit}.prose code{font-size:87.5%}.prose pre{font-size:75%}.prose p:first-child{font-size:1.25rem}@media(min-width:40em){.prose,.serif{font-size:1.25rem}.prose p:first-child{font-size:1.5rem}}</style></head><body class="container px2"><header class="py3"><h1 class="h3 m0"><a href="/writing" class="link-simple">jxnblk.com/writing</a></h1><div><h1 class="mt1 mb0">Static Site Generation with React and Webpack</h1><div class="h5 bold">Sat Jun 06 2015</div></div></header><div class="py2"><div class="prose mb3"><p>I’ve been dabbling with React for a few months now and using it in several small open source projects
to better understand the technology.
React’s focus on reusablility, along with the ability to install and require components via npm,
provides an elegant way to rapidly build application UI in an efficient and consistent way.
It’s also a great way to handle server-side rendering and provides high cohesion between markup and display logic.</p>
<h2 id="why">Why</h2>
<p>React is incredibly intuitive and flexible to work with,
but relying solely on client side rendering
leaves a lot to be desired in regards to percieved performance.
With a static React site, the page loads just like any other static HTML,
and the JavaScript kicks in whenever it’s downloaded.
This is extremely helpful for combining documentation with interactive demonstrations,
like <a href="http://jxnblk.com/colorable">Colorable</a> or <a href="http://jxnblk.com/react-icons">Building SVG Icons with React</a>.
Using React with webpack also allows you to consolidate the entire build process 
in Node and take advantage of anything in the npm ecosystem.
Last but not least, React is just fun to use.</p>
<h2 id="how">How</h2>
<p>Although there are several ways to render static sites with React,
the following is what I’ve found to be easiest.</p>
<p>First start a fresh project and initialize npm.</p>
<pre>mkdir react-static-site
<span class="hljs-built_in">cd</span> react-static-site
npm init</pre><p>Install the following modules.</p>
<pre>npm i --save-dev react webpack webpack-dev-server jsx-loader static-site-generator-webpack-plugin react-router</pre><p><a href="http://webpack.github.io/" target="_blank">Webpack</a> and webpack-dev-server will be used for the entire build process and can also handle assets such as CSS, images, and fonts.
The jsx-loader is used to transpile imported jsx files. If you prefer ES6, you can use babel-loader instead of jsx-loader.
The <a href="https://github.com/markdalgleish/static-site-generator-webpack-plugin" target="_blank">static-site-generator-webpack-plugin</a> module is what is used to generate static HTML.
And <a href="http://rackt.github.io/react-router/" target="_blank">React Router</a> is used to handle routing. For single page static sites, React Router is not needed.</p>
<h2 id="set-up-webpack">Set up Webpack</h2>
<p>Webpack is a module bundler similar to Browserify, but can also replace front-end build systems like Grunt and Gulp.</p>
<p>First off, you’ll need a <code>webpack.config.js</code> file. The webpack command line interface will use this config file.</p>
<pre><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">var</span> StaticSiteGeneratorPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'static-site-generator-webpack-plugin'</span>)
<span class="hljs-keyword">var</span> data = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./data'</span>)

<span class="hljs-built_in">module</span>.exports = {
  entry: <span class="hljs-string">'./entry.js'</span>,

  output: {
    filename: <span class="hljs-string">'bundle.js'</span>,
    path: __dirname,
    libraryTarget: <span class="hljs-string">'umd'</span>
  },

  <span class="hljs-built_in">module</span>: {
    loaders: [
      { test: <span class="hljs-regexp">/\.jsx$/</span>, loader: <span class="hljs-string">'jsx-loader'</span> }
    ]
  },

  plugins: [
    <span class="hljs-keyword">new</span> StaticSiteGeneratorPlugin(<span class="hljs-string">'bundle.js'</span>, data.routes, data)
  ]
}</pre><h2 id="create-an-entry-file">Create an Entry File</h2>
<p>The entry file is what webpack will read to build <code>bundle.js</code>,
and the static-site-generator-webpack-plugin uses the bundle to generate HTML.</p>
<p>For a single rendered page, you can skip React Router and create an <code>entry.js</code> file like the following.</p>
<pre><span class="hljs-comment">// entry.js with no routing</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Root = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Root.jsx'</span>)

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">locals, callback</span>) </span>{
  <span class="hljs-keyword">var</span> html = React.renderToStaticMarkup(React.createElement(Root, locals))
  callback(<span class="hljs-literal">null</span>, <span class="hljs-string">'&lt;!DOCTYPE html&gt;'</span> + html)
}</pre><p>For handling multiple routes, update the entry file using React Router and create a <code>Routes.jsx</code> file.</p>
<pre><span class="hljs-comment">// entry.js</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> Routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Routes.jsx'</span>)

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">locals, callback</span>) </span>{
  Router.run(Routes, locals.path, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Handler</span>) </span>{
    <span class="hljs-keyword">var</span> html = React.renderToStaticMarkup(React.createElement(Handler, locals))
    callback(<span class="hljs-literal">null</span>, <span class="hljs-string">'&lt;!DOCTYPE html&gt;'</span> + html)
  })
}</pre><pre><span class="hljs-comment">// Routes.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> Route = Router.Route
<span class="hljs-keyword">var</span> DefaultRoute = Router.DefaultRoute
<span class="hljs-keyword">var</span> Root = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Root.jsx'</span>)
<span class="hljs-keyword">var</span> Index = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Index.jsx'</span>)

<span class="hljs-keyword">var</span> Routes = (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">Route</span> <span class="hljs-attribute">handler</span>=<span class="hljs-value">{Root}</span> <span class="hljs-attribute">path</span>=<span class="hljs-value">'/'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">DefaultRoute</span> <span class="hljs-attribute">handler</span>=<span class="hljs-value">{Index}</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">Route</span>&gt;</span>
)</span>

<span class="hljs-built_in">module</span>.exports = Routes</pre><h2 id="create-a-data-file">Create a Data File</h2>
<p>Next create a <code>data.js</code> file that will include initial props passed to the Root component and routes used for the router.</p>
<pre><span class="hljs-comment">// data.js</span>
<span class="hljs-built_in">module</span>.exports = {
  title: <span class="hljs-string">'My Static Site'</span>,
  routes: [
    <span class="hljs-string">'/'</span>
  ]
}</pre><h2 id="create-root-jsx">Create Root.jsx</h2>
<p>The Root component will include the <code>&lt;html&gt;</code> element, <code>&lt;head&gt;</code> and other code that will be shared across all pages.
The page components themselves will be passed through the <code>&lt;RouteHander&gt;</code> component with React Router.
To keep things somewhat organized, create this file in a new <code>components</code> directory.</p>
<pre><span class="hljs-comment">// components/Root.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> RouteHandler = Router.RouteHandler

<span class="hljs-keyword">var</span> Root = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>{this.props.title}<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">RouteHandler</span> {<span class="hljs-attribute">...this.props</span>} /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Root</pre><h2 id="create-index-jsx">Create Index.jsx</h2>
<p>The Index component will be the page rendered with <code>&lt;DefaultRoute&gt;</code> and should contain the content for the root <code>index.html</code> file.</p>
<pre><span class="hljs-comment">// components/Index.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)

<span class="hljs-keyword">var</span> Index = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">main</span>&gt;</span>
        Index component
      <span class="hljs-tag">&lt;/<span class="hljs-title">main</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Index</pre><h2 id="package-scripts">Package Scripts</h2>
<p>Add the following scripts to <code>package.json</code> to run webpack.</p>
<pre>"scripts": {
  "webpack": "webpack --progress --colors",
  "dev": "webpack-dev-server --progress --colors",
  "start": "npm run dev"
}</pre><p>Run the start script to start a development server.</p>
<pre>npm start</pre><p>Open <a href="http://localhost:8080" target="_blank">http://localhost:8080</a> in a browser.
You should see an unstyled page with the words <em>Index component</em>.</p>
<h2 id="adding-pages">Adding Pages</h2>
<p>Next, add a new route for an <em>about</em> page.
In <code>data.js</code> add <code>/about</code> to the routes array.</p>
<pre><span class="hljs-comment">// data.js</span>
<span class="hljs-built_in">module</span>.exports = {
  title: <span class="hljs-string">'My Static Site'</span>,
  routes: [
    <span class="hljs-string">'/'</span>,
    <span class="hljs-string">'/about'</span>
  ]
}</pre><p>Edit the <code>Routes.jsx</code> file to handle the new route.</p>
<pre><span class="hljs-comment">// Routes.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> Route = Router.Route
<span class="hljs-keyword">var</span> DefaultRoute = Router.DefaultRoute
<span class="hljs-keyword">var</span> Root = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Root.jsx'</span>)
<span class="hljs-keyword">var</span> Index = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Index.jsx'</span>)
<span class="hljs-keyword">var</span> About = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/About.jsx'</span>)

<span class="hljs-keyword">var</span> Routes = (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">Route</span> <span class="hljs-attribute">handler</span>=<span class="hljs-value">{Root}</span> <span class="hljs-attribute">path</span>=<span class="hljs-value">'/'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">DefaultRoute</span> <span class="hljs-attribute">handler</span>=<span class="hljs-value">{Index}</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Route</span> <span class="hljs-attribute">path</span>=<span class="hljs-value">'/about'</span> <span class="hljs-attribute">handler</span>=<span class="hljs-value">{About}</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">Route</span>&gt;</span>
)</span>

<span class="hljs-built_in">module</span>.exports = Routes</pre><p>Create a new <code>About.jsx</code> component.</p>
<pre><span class="hljs-comment">// components/About.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)

<span class="hljs-keyword">var</span> About = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">main</span>&gt;</span>
        About component
      <span class="hljs-tag">&lt;/<span class="hljs-title">main</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = About</pre><p>Stop and restart the development server and navigate to
<a href="http://localhost:8080/about" target="_blank">http://localhost:8080/about</a>.
You should see a page similar to the index but with the words <em>About component</em>.</p>
<p>React-router can also handle route params such as <code>posts/:id</code> for dynamic routing –
<a href="http://rackt.github.io/react-router/" target="_blank">View the docs</a> to learn more.</p>
<h2 id="render-to-static-markup">Render to Static Markup</h2>
<p>Stop the development server and run <code>npm run webpack</code>. This should generate two static <code>index.html</code> files in the root and <code>about</code> directories.</p>
<h2 id="adding-client-side-js">Adding Client-Side JS</h2>
<p>In order to use React for client side JavaScript, you’ll need to ensure that the props match up between the static page and the bundle.js file.</p>
<p>First, edit <code>entry.js</code> to change the render function
from <code>React.renderToStaticMarkup</code> to <code>React.renderString</code>
and add a conditional block that will only run client-side.</p>
<pre><span class="hljs-comment">// entry.js</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> Routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Routes.jsx'</span>)

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span> !== <span class="hljs-string">'undefined'</span>) {
  <span class="hljs-keyword">var</span> initialProps = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'initial-props'</span>).innerHTML)
  Router.run(Routes, Router.HistoryLocation, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Handler</span>) </span>{
    React.render(React.createElement(Handler, initialProps), <span class="hljs-built_in">document</span>)
  })
}

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">locals, callback</span>) </span>{
  Router.run(Routes, locals.path, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Handler</span>) </span>{
    <span class="hljs-keyword">var</span> html = React.renderToString(React.createElement(Handler, locals))
    callback(<span class="hljs-literal">null</span>, <span class="hljs-string">'&lt;!DOCTYPE html&gt;'</span> + html)
  })
}</pre><p>The <code>initialProps</code> value will come from a script tag with the id <code>initial-props</code>.
Update the Root component to add this script tag, add a <code>safeStringify</code> function, and link to the <code>bundle.js</code> file.</p>
<pre><span class="hljs-comment">// components/Root.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> RouteHandler = Router.RouteHandler

<span class="hljs-keyword">var</span> Root = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> initialProps = {
      __html: safeStringify(<span class="hljs-keyword">this</span>.props)
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>{this.props.title}<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">RouteHandler</span> {<span class="hljs-attribute">...this.props</span>} /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span>
            <span class="hljs-attribute">id</span>=<span class="hljs-value">'initial-props'</span>
            <span class="hljs-attribute">type</span>=<span class="hljs-value">'application/json'</span>
            <span class="hljs-attribute">dangerouslySetInnerHTML</span>=<span class="hljs-value">{initialProps}</span> /&gt;</span><span class="xml">
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'bundle.js'</span> /&gt;</span><span class="xml">
        <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
    )</span></span></span>
  }
})

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeStringify</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj).replace(<span class="hljs-regexp">/&lt;\/script/g</span>, <span class="hljs-string">'&lt;\\/script'</span>).replace(<span class="hljs-regexp">/&lt;!--/g</span>, <span class="hljs-string">'&lt;\\!--'</span>)
}

<span class="hljs-built_in">module</span>.exports = Root</pre><h2 id="navigation-links">Navigation Links</h2>
<p>To link the pages together, create a new Header component.</p>
<pre><span class="hljs-comment">// components/Header.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)

<span class="hljs-keyword">var</span> Header = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">'/'</span>&gt;</span>Index<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">'/about'</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">header</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Header</pre><p>Add the Header to the Root component’s render function.</p>
<pre><span class="hljs-comment">// components/Root.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> RouteHandler = Router.RouteHandler
<span class="hljs-keyword">var</span> Header = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Header.jsx'</span>)

<span class="hljs-keyword">var</span> Root = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> initialProps = {
      __html: safeStringify(<span class="hljs-keyword">this</span>.props)
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>{this.props.title}<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">Header</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">RouteHandler</span> {<span class="hljs-attribute">...this.props</span>} /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span>
            <span class="hljs-attribute">id</span>=<span class="hljs-value">'initial-props'</span>
            <span class="hljs-attribute">type</span>=<span class="hljs-value">'application/json'</span>
            <span class="hljs-attribute">dangerouslySetInnerHTML</span>=<span class="hljs-value">{initialProps}</span> /&gt;</span><span class="xml">
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'bundle.js'</span> /&gt;</span><span class="xml">
        <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
    )</span></span></span>
  }
})

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeStringify</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj).replace(<span class="hljs-regexp">/&lt;\/script/g</span>, <span class="hljs-string">'&lt;\\/script'</span>).replace(<span class="hljs-regexp">/&lt;!--/g</span>, <span class="hljs-string">'&lt;\\!--'</span>)
}

<span class="hljs-built_in">module</span>.exports = Root</pre><h2 id="using-client-side-routing">Using Client-Side Routing</h2>
<p>React router can also do client-side routing using the Link component.
This can make transitioning pages feel faster and behaves like a fake single-page application.</p>
<p>To use client-side routing, replace the anchor links in the Header with React Routers’s Link components.</p>
<pre><span class="hljs-comment">// components/Header.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> Link = Router.Link

<span class="hljs-keyword">var</span> Header = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Link</span> <span class="hljs-attribute">to</span>=<span class="hljs-value">'/'</span>&gt;</span>Index<span class="hljs-tag">&lt;/<span class="hljs-title">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Link</span> <span class="hljs-attribute">to</span>=<span class="hljs-value">'/about'</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-title">Link</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">header</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Header</pre><h2 id="adding-critical-css">Adding Critical CSS</h2>
<p>Although there are many different approaches to styling components in React,
adding some critical CSS base styles to the head can help speed up performance and development time.
You can skip this step if you prefer using inline styles or linking to a larger stylesheet.</p>
<p><em>UPDATE: Originally, this tutorial showed how to include CSS using props.
Using a combination of css-loader and cssnext-loader seems to be a better solution
as it doesn&#39;t require restarting the server when making changes to the stylesheet
and doesn&#39;t duplicate the CSS in the <code>initialProps</code> JSON object.</em></p>
<p>First install <a href="http://basscss.com" target="_blank">Basscss</a>,
<a href="https://github.com/webpack/css-loader" target="_blank">css-loader</a>,
and <a href="https://github.com/cssnext/cssnext-loader" target="_blank">cssnext-loader</a>.</p>
<pre>npm i --save-dev basscss css-loader cssnext-loader</pre><p>Add css-loader and cssnext-loader to the webpack config as well as options for cssnext.</p>
<pre><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">var</span> StaticSiteGeneratorPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'static-site-generator-webpack-plugin'</span>)
<span class="hljs-keyword">var</span> data = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./data'</span>)

<span class="hljs-built_in">module</span>.exports = {
  entry: <span class="hljs-string">'./entry.js'</span>,

  output: {
    filename: <span class="hljs-string">'bundle.js'</span>,
    path: __dirname,
    libraryTarget: <span class="hljs-string">'umd'</span>
  },

  <span class="hljs-built_in">module</span>: {
    loaders: [
      { test: <span class="hljs-regexp">/\.jsx$/</span>, loader: <span class="hljs-string">'jsx-loader'</span> },
      { test: <span class="hljs-regexp">/\.css/</span>, loader: <span class="hljs-string">'css-loader!cssnext-loader'</span> }
    ]
  },

  plugins: [
    <span class="hljs-keyword">new</span> StaticSiteGeneratorPlugin(<span class="hljs-string">'bundle.js'</span>, data.routes, data)
  ],

  cssnext: {
    compress: <span class="hljs-literal">true</span>,
    features: {
      rem: <span class="hljs-literal">false</span>,
      pseudoElements: <span class="hljs-literal">false</span>,
      colorRgba: <span class="hljs-literal">false</span>
    }
  }

}</pre><p>In the cssnext configuration options, the output is compressed and the rem and colorRgba postcss plugins have been disabled.</p>
<p>Create a new <code>css</code> directory and a <code>base.css</code> file.
Import Basscss and set a new value for the <code>--font-family</code> custom property.</p>
<pre><span class="hljs-comment">/* css/base.css */</span>
<span class="hljs-at_rule">@<span class="hljs-keyword">import</span> <span class="hljs-string">'basscss'</span></span>;

<span class="hljs-pseudo">:root</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">--font-family</span>:<span class="hljs-value"> <span class="hljs-string">'Avenier Next'</span>, <span class="hljs-string">'Hevletica Neue'</span>, sans-serif</span></span>;
}</span></pre><p>In the Root component, import the stylesheet, add a style tag to the head, and add some padding to the body.</p>
<pre><span class="hljs-comment">// components/Root.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-router'</span>)
<span class="hljs-keyword">var</span> RouteHandler = Router.RouteHandler
<span class="hljs-keyword">var</span> Header = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Header.jsx'</span>)
<span class="hljs-keyword">var</span> css = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../css/base.css'</span>)

<span class="hljs-keyword">var</span> Root = React.createClass({
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> initialProps = {
      __html: safeStringify(<span class="hljs-keyword">this</span>.props)
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>{this.props.title}<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">style</span> <span class="hljs-attribute">dangerouslySetInnerHTML</span>=<span class="hljs-value">{{</span> <span class="hljs-attribute">__html:</span> <span class="hljs-attribute">css</span> }} /&gt;</span><span class="css">
        &lt;/<span class="hljs-tag">head</span>&gt;
        &lt;<span class="hljs-tag">body</span> <span class="hljs-tag">className</span>='<span class="hljs-tag">p2</span>'&gt;
          &lt;<span class="hljs-tag">Header</span> /&gt;
          &lt;<span class="hljs-tag">RouteHandler</span> <span class="hljs-rules">{...this.props}</span> /&gt;
          &lt;<span class="hljs-tag">script</span>
            <span class="hljs-tag">id</span>='<span class="hljs-tag">initial-props</span>'
            <span class="hljs-tag">type</span>='<span class="hljs-tag">application</span>/<span class="hljs-tag">json</span>'
            <span class="hljs-tag">dangerouslySetInnerHTML</span>=<span class="hljs-rules">{initialProps}</span> /&gt;
          &lt;<span class="hljs-tag">script</span> <span class="hljs-tag">src</span>='<span class="hljs-tag">bundle</span><span class="hljs-class">.js</span>' /&gt;
        &lt;/<span class="hljs-tag">body</span>&gt;
      &lt;/<span class="hljs-tag">html</span>&gt;
    )</span></span>
  }
})

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeStringify</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj).replace(<span class="hljs-regexp">/&lt;\/script/g</span>, <span class="hljs-string">'&lt;\\/script'</span>).replace(<span class="hljs-regexp">/&lt;!--/g</span>, <span class="hljs-string">'&lt;\\!--'</span>)
}

<span class="hljs-built_in">module</span>.exports = Root</pre><p>Restart the dev server to see the changes.</p>
<p>You should now have a basic static site rendered with React.
For a complete example, see the
<a href="https://github.com/jxnblk/react-static-site-boilerplate" target="_blank">Boilerplate Demo</a>
or check out the
<a href="https://github.com/jxnblk/writing" target="_blank">source for this blog</a>, which uses a very similar approach.</p>
<h2 id="other-considerations-and-improvements">Other Considerations and Improvements</h2>
<p>Since this uses webpack, there are also ways to include image assets and fonts in the bundle, but I haven’t tried this so your mileage may vary.</p>
<p>The <code>routes</code> array is passed in as props, and navigation links could be created dynamically rather than being hard coded.
This could make handling lots of pages easier.</p>
<p>If you’re hosting the static site on gh-pages, you’ll need a way to handle the base url when using React Router’s Link component.
I don’t know of a good way to do this yet and would love to hear suggestions on how to improve that.</p>
<p><del>Handling the CSS as shown above can lead to a fairly large chunk of JSON being inserted into the initial-props script tag,
and I’m not sure if there’s a better way to handle that.</del></p>
<p>This is just one way to build static sites with React.
You might also be interested in Brad Denver’s blog post <a href="http://braddenver.com/blog/2015/react-static-site.html" target="_blank">React Static Site</a>.
If you’ve seen other ways or have any suggestions for improving on this, I’d love to hear them.</p>
</div><noscript></noscript><div><h4>Questions, Comments, Suggestions?</h4><a href="https://github.com/jxnblk/writing/issues/new?title=Static Site Generation with React and Webpack" class="bold" target="_blank">Open an Issue</a></div><div class="mt3"><div class="inline-block"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Static Site Generation with React and Webpack" data-via="jxnblk" data-size="large">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?"http":"https";if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document, "script", "twitter-wjs");</script></div></div></div><footer class="center py4 border-top"><a href="/" class="bold link-simple"><svg viewBox="0 0 128 128" width="48" height="48" fill="currentcolor"><path d="M64 0 L64 4 L76 4 L74 6 L94 14 L92 16 L104 20 L100 22 L106 28 L102 28 L106 56 Q110 62 110 70 T105 84 L96 108 C92 116 76 128 64 128 C52 128 36 116 32 108 L23 84 Q18 78 18 70 T22 56 L22 22 L26 24 L34 12 L36 16z M72 40 Q56 30 40 30 Q32 34 30 48 L30 48 L28 74 C28 81 37 102 38 104 C46 118 62 121 64 121 C66 121 82 118 90 104 C91 102 100 81 100 74 L99 52 L94 40 L92 42 L84 38 L84 42 L74 36 M44 62 A5.5 5.5 0 0 0 44 73 A5.5 5.5 0 0 0 44 62 M84 62 A5.5 5.5 0 0 0 84 73 A5.5 5.5 0 0 0 84 62 M57 88 H71 A2 2 0 0 1 71 92 H57 A2 2 0 0 1 57 88 M53 104 H75 A2 2 0 0 1 75 108 H53 A2 2 0 0 1 53 104 M33.3 60.4 C34.6 57.8 37 55.9 39.7 55.2 C43 54.4 46.8 55.3 50.4 58 C51.3 58.6 52.5 58.4 53.2 57.5 C53.8 56.6 53.6 55.4 52.7 54.7 C46.8 50.5 41.8 50.5 38.7 51.3 C34.8 52.3 31.5 54.9 29.7 58.6 C29.2 59.6 29.6 60.8 30.6 61.3 C30.9 61.4 31.2 61.5 31.5 61.5 C32.2 61.5 32.9 61.1 33.3 60.4 z M97.7 61.9 C98.5 61.2  98.6  59.9  97.9  59.1 C94.3 55  90.1  52.9  85.4  53 C82 53  78.3  54.2  74.3  56.6 C73.3 57.2  73  58.4  73.6  59.3 C74.2 60.3  75.4  60.6  76.3  60 C79.7 58  82.7  57  85.5  57 C89 57  92.1  58.5  95  61.7 C95.4 62.2  95.9  62.4  96.5  62.4 C96.8 62.4 97.3 62.2 97.7 61.9 z"></path></svg><div>Made by Jxnblk</div></a></footer><script>(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,"script","//www.google-analytics.com/analytics.js","ga"); ga("create", "UA-4603832-6", "auto"); ga("send", "pageview");</script></body></html>